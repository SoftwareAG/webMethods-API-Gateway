{
  "swagger" : "2.0",
  "info" : {
    "description" : "API Gateway Approval Management Service allows you to manage the different types of approval configuration in API Gateway. Any user with the 'Administration configurations' functional privilege can manage the Approval configuration. Also they can approve and reject the Approval requests. By default, the users who are part of either API-Gateway-Providers or API-Gateway-Administrators groups will have this privilege. Any user who is part of the aproval team has functional privilege to approve or reject the Approval request. User who created the approval request can also delete it if not needed. As of now approval configuration consist of few events. They are 1. Create application, 2. Register application, 3. Update application, 4. Subscribe package and 5. Change owner/teams. Once it is enabled then the respective operation will not happen without approving the request. For example if the user enables Create application Approval configuration, then while creating application the user needs to approve the application creation approval request to create the application. This is the same with the other configurations also. In addition to that user can enable send notification option to send notification to approver for 1. Approval initiation, 2. Accepting approval and 3. Rejecting Approval. They can also configure the email template for the events to be sent to the approver.",
    "version" : "10.7",
    "title" : "API Gateway Approvals Management Service"
  },
  "host" : "localhost:5555",
  "basePath" : "/rest/apigateway",
  "schemes" : [ "http" ],
  "consumes" : [ "application/json" ],
  "produces" : [ "application/json" ],
  "paths" : {
    "/approvals/{approvalId}/{action}" : {
      "put" : {
        "description" : "Approve/Reject the Approval Request with given approvalId and action",
        "operationId" : "approveorrejectApprovalRequest",
        "consumes" : [ "application/json" ],
        "produces" : [ "application/json" ],
        "parameters" : [ {
          "name" : "approvalId",
          "in" : "path",
          "description" : "ApprovalId for the Approval Request to be approved",
          "required" : true,
          "type" : "string",
          "x-example" : "353bd366-47d4-4703-aecf-9cb40cdcc864"
        }, {
          "name" : "action",
          "in" : "path",
          "description" : "Action for the Approval Request to be approved/rejected",
          "required" : true,
          "type" : "string",
          "x-example" : "approve/reject"
        }, {
          "in" : "body",
          "name" : "body",
          "description" : "Approval Request payload",
          "required" : false,
          "schema" : {
            "$ref" : "#/definitions/ApprovalRequest"
          }
        } ],
        "responses" : {
          "200" : {
            "description" : "Returns the approved/rejected status after successfully approved/rejected the Approval Request",
            "schema" : {
              "$ref" : "#/definitions/ApprovalResponse"
            }
          },
          "404" : {
            "description" : "This status code indicates that the approvalId specified is not found in the API Gateway"
          },
          "401" : {
            "description" : ""
          }
        },
        "security" : [ {
          "Basic" : [ ]
        } ]
      }
    },
    "/approvals" : {
      "get" : {
        "description" : "Get all Approvals",
        "operationId" : "getApprovals",
        "produces" : [ "application/json" ],
        "parameters" : [ ],
        "responses" : {
          "200" : {
            "description" : "Returns the list of all Approval Requests",
            "schema" : {
              "type" : "array",
              "items" : {
                "$ref" : "#/definitions/ApprovalRequest"
              }
            }
          },
          "401" : {
            "description" : ""
          }
        },
        "security" : [ {
          "Basic" : [ ]
        } ]
      }
    },
    "/approvals/{approvalId}" : {
      "get" : {
        "description" : "Retrieve an Approval Request based on the Approval id.",
        "operationId" : "getApproval",
        "produces" : [ "application/json" ],
        "parameters" : [ {
          "name" : "approvalId",
          "in" : "path",
          "description" : "Approval Id for the Approval Request to be retrieved",
          "required" : true,
          "type" : "string",
          "x-example" : "353bd366-47d4-4703-aecf-9cb40cdcc864"
        } ],
        "responses" : {
          "200" : {
            "description" : "returns the approval requests object based on the given approvalId",
            "schema" : {
              "$ref" : "#/definitions/ApprovalRequest"
            }
          },
          "404" : {
            "description" : "This status code indicates that the approvalId specified is not found in the API Gateway"
          },
          "401" : {
            "description" : ""
          }
        },
        "security" : [ {
          "Basic" : [ ]
        } ]
      },
      "delete" : {
        "description" : "Delete the Approval Request with the given approvalId",
        "operationId" : "deleteApprovalRequest",
        "parameters" : [ {
          "name" : "approvalId",
          "in" : "path",
          "description" : "Approval Request Id for the Approval Request to be deleted",
          "required" : true,
          "type" : "string",
          "x-example" : "353bd366-47d4-4703-aecf-9cb40cdcc864"
        } ],
        "responses" : {
          "404" : {
            "description" : "This status code indicates that the approvalId specified is not found in the API Gateway"
          },
          "401" : {
            "description" : "Access Denied"
          },
          "204" : {
            "description" : "Success"
          }
        },
        "security" : [ {
          "Basic" : [ ]
        } ]
      }
    },
    "/approvalConfigurations/{id}" : {
      "get" : {
        "description" : "The method retrieves the details of a specified approval configuration in API Gateway",
        "operationId" : "getApprovalConfiguration",
        "produces" : [ "application/json" ],
        "parameters" : [ {
          "name" : "id",
          "in" : "path",
          "description" : "This parameter specifies the ID of an approval configuration whose details are to be retrieved in API Gateway.",
          "required" : true,
          "type" : "string"
        } ],
        "responses" : {
          "200" : {
            "description" : "This status code indicates that the details of the specified approval configuration are retrieved successfully.",
            "examples" : {
              "application/json" : "{\r\n    \"approvalConfig\": {\r\n        \"id\": \"createApplication\",\r\n        \"eventType\": \"createApplication\",\r\n        \"isEnabled\": true,\r\n        \"approversGroupId\": \"0936de2c-9fb9-4625-b5b0-b7648e0d4103\",\r\n        \"approvalMode\": \"anyone\",\r\n        \"approvedEmailConfiguration\": {\r\n            \"emailSubject\": \"Approval of @event.type\",\r\n            \"emailContent\": \"Congratulations @requestor.name !\\n\\nYour request for @event.type has been approved.\",\r\n            \"enabled\": false,\r\n            \"requestType\": \"approved\"\r\n        },\r\n        \"rejectedEmailConfiguration\": {\r\n            \"emailSubject\": \"Rejection of @event.type\",\r\n            \"emailContent\": \"Hello @requestor.name,\\n\\nYour @event.type  request has been rejected.\\nReasons:@rejectionReason.\\n\\nBest Regards,\\nAPI Gateway Team\\n\\n*** This notification was sent automatically. Do not reply to this email.***\",\r\n            \"enabled\": false,\r\n            \"requestType\": \"rejected\"\r\n        },\r\n        \"initiateApprovalRequestEmailConfiguration\": {\r\n            \"emailSubject\": \"Approval request pending\",\r\n            \"emailContent\": \"Hello @approver.name,\\n\\n A request by @requestor.name to @event.type needs your review and approval.\\n\\nBest Regards,\\nAPI Gateway Team\\n\\n*** This notification was sent automatically. Do not reply to this email.***\",\r\n            \"enabled\": false,\r\n            \"requestType\": \"initiate\"\r\n        }\r\n    }\r\n}"
            },
            "schema" : {
              "$ref" : "#/definitions/ApprovalConfiguration"
            }
          },
          "404" : {
            "description" : "This status code indicates that an approval configuration with the given ID could not be found in API Gateway."
          },
          "401" : {
            "description" : "This status code indicates that either user didn't provide right credentials or user doesn't have required privileges to access this API."
          }
        },
        "security" : [ {
          "Basic" : [ ]
        } ]
      },
      "put" : {
        "description" : "The method updates the approval configuration in API Gateway.",
        "operationId" : "updateApprovalConfiguration",
        "consumes" : [ "application/json" ],
        "produces" : [ "application/json" ],
        "parameters" : [ {
          "in" : "body",
          "name" : "body",
          "description" : "This parameter describes the request payload of an approval configuration that is to be updated in API Gateway.",
          "required" : true,
          "schema" : {
            "$ref" : "#/definitions/ApprovalConfiguration"
          },
          "x-examples" : {
            "application/json" : "{\r\n    \"approvalConfig\": {\r\n        \"id\": \"createApplication\",\r\n        \"eventType\": \"createApplication\",\r\n        \"isEnabled\": true,\r\n        \"approversGroupId\": \"0936de2c-9fb9-4625-b5b0-b7648e0d4103\",\r\n        \"approvalMode\": \"anyone\",\r\n        \"approvedEmailConfiguration\": {\r\n            \"emailSubject\": \"Approval of @event.type\",\r\n            \"emailContent\": \"Congratulations @requestor.name !\\n\\nYour request for @event.type has been approved.\",\r\n            \"enabled\": false,\r\n            \"requestType\": \"approved\"\r\n        },\r\n        \"rejectedEmailConfiguration\": {\r\n            \"emailSubject\": \"Rejection of @event.type\",\r\n            \"emailContent\": \"Hello @requestor.name,\\n\\nYour @event.type  request has been rejected.\\nReasons:@rejectionReason.\\n\\nBest Regards,\\nAPI Gateway Team\\n\\n*** This notification was sent automatically. Do not reply to this email.***\",\r\n            \"enabled\": false,\r\n            \"requestType\": \"rejected\"\r\n        },\r\n        \"initiateApprovalRequestEmailConfiguration\": {\r\n            \"emailSubject\": \"Approval request pending\",\r\n            \"emailContent\": \"Hello @approver.name,\\n\\n A request by @requestor.name to @event.type needs your review and approval.\\n\\nBest Regards,\\nAPI Gateway Team\\n\\n*** This notification was sent automatically. Do not reply to this email.***\",\r\n            \"enabled\": false,\r\n            \"requestType\": \"initiate\"\r\n        }\r\n    }\r\n}"
          }
        }, {
          "name" : "id",
          "in" : "path",
          "description" : "This parameter specifies the ID of an approval configuration that is to be updated in API Gateway.",
          "required" : true,
          "type" : "string"
        } ],
        "responses" : {
          "200" : {
            "description" : "This status code indicates that the approval configuration has been successfully updated in API Gateway.",
            "examples" : {
              "application/json" : "{\r\n    \"approvalConfig\": {\r\n        \"id\": \"createApplication\",\r\n        \"eventType\": \"createApplication\",\r\n        \"isEnabled\": true,\r\n        \"approversGroupId\": \"0936de2c-9fb9-4625-b5b0-b7648e0d4103\",\r\n        \"approvalMode\": \"anyone\",\r\n        \"approvedEmailConfiguration\": {\r\n            \"emailSubject\": \"Approval of @event.type\",\r\n            \"emailContent\": \"Congratulations @requestor.name !\\n\\nYour request for @event.type has been approved.\",\r\n            \"enabled\": false,\r\n            \"requestType\": \"approved\"\r\n        },\r\n        \"rejectedEmailConfiguration\": {\r\n            \"emailSubject\": \"Rejection of @event.type\",\r\n            \"emailContent\": \"Hello @requestor.name,\\n\\nYour @event.type  request has been rejected.\\nReasons:@rejectionReason.\\n\\nBest Regards,\\nAPI Gateway Team\\n\\n*** This notification was sent automatically. Do not reply to this email.***\",\r\n            \"enabled\": false,\r\n            \"requestType\": \"rejected\"\r\n        },\r\n        \"initiateApprovalRequestEmailConfiguration\": {\r\n            \"emailSubject\": \"Approval request pending\",\r\n            \"emailContent\": \"Hello @approver.name,\\n\\n A request by @requestor.name to @event.type needs your review and approval.\\n\\nBest Regards,\\nAPI Gateway Team\\n\\n*** This notification was sent automatically. Do not reply to this email.***\",\r\n            \"enabled\": false,\r\n            \"requestType\": \"initiate\"\r\n        }\r\n    }\r\n}"
            },
            "schema" : {
              "$ref" : "#/definitions/ApprovalConfiguration"
            }
          },
          "400" : {
            "description" : "This status code indicates that the given approval configuration request body is not correct."
          },
          "401" : {
            "description" : "This status code indicates that either user didn't provide right credentials or user doesn't have required privileges to access this API."
          }
        },
        "security" : [ {
          "Basic" : [ ]
        } ]
      },
      "delete" : {
        "description" : "The method deletes the specified approval configuration in API Gateway.",
        "operationId" : "deleteApprovalConfiguration",
        "produces" : [ "application/json" ],
        "parameters" : [ {
          "name" : "id",
          "in" : "path",
          "description" : "This parameter specifies the ID of an approval configuration that is to be deleted in API Gateway.",
          "required" : true,
          "type" : "string"
        } ],
        "responses" : {
          "401" : {
            "description" : "This status code indicates that either user didn't provide right credentials or user doesn't have required privileges to access this API."
          },
          "204" : {
            "description" : "This status code indicates that the specified approval configuration has been successfully deleted from API Gateway."
          },
          "404" : {
            "description" : "This status code indicates that an approval configuration with the given ID could not be found in API Gateway."
          }
        },
        "security" : [ {
          "Basic" : [ ]
        } ]
      }
    },
    "/approvalConfigurations" : {
      "get" : {
        "description" : "The method retrieves a list of available approval configurations in API Gateway.",
        "operationId" : "getApprovalConfigurations",
        "produces" : [ "application/json" ],
        "parameters" : [ ],
        "responses" : {
          "200" : {
            "description" : "This status code indicates that a list of the available approval configurations is retrieved successfully.",
            "examples" : {
              "application/json" : "{\r\n    \"approvalConfigurations\": [\r\n        {\r\n            \"id\": \"createApplication\",\r\n            \"eventType\": \"createApplication\",\r\n            \"isEnabled\": true,\r\n            \"approversGroupId\": \"0936de2c-9fb9-4625-b5b0-b7648e0d4103\",\r\n            \"approvalMode\": \"anyone\",\r\n            \"approvedEmailConfiguration\": {\r\n                \"emailSubject\": \"Approval of @event.type\",\r\n                \"emailContent\": \"Congratulations @requestor.name !\\n\\nYour request for @event.type has been approved.\",\r\n                \"enabled\": false,\r\n                \"requestType\": \"approved\"\r\n            },\r\n            \"rejectedEmailConfiguration\": {\r\n                \"emailSubject\": \"Rejection of @event.type\",\r\n                \"emailContent\": \"Hello @requestor.name,\\n\\nYour @event.type  request has been rejected.\\nReasons:@rejectionReason.\\n\\nBest Regards,\\nAPI Gateway Team\\n\\n*** This notification was sent automatically. Do not reply to this email.***\",\r\n                \"enabled\": false,\r\n                \"requestType\": \"rejected\"\r\n            },\r\n            \"initiateApprovalRequestEmailConfiguration\": {\r\n                \"emailSubject\": \"Approval request pending\",\r\n                \"emailContent\": \"Hello @approver.name,\\n\\n A request by @requestor.name to @event.type needs your review and approval.\\n\\nBest Regards,\\nAPI Gateway Team\\n\\n*** This notification was sent automatically. Do not reply to this email.***\",\r\n                \"enabled\": false,\r\n                \"requestType\": \"initiate\"\r\n            }\r\n        }\r\n    ]\r\n}"
            },
            "schema" : {
              "$ref" : "#/definitions/ApprovalConfiguration"
            }
          },
          "401" : {
            "description" : "This status code indicates that either user didn't provide right credentials or user doesn't have required privileges to access this API."
          }
        },
        "security" : [ {
          "Basic" : [ ]
        } ]
      },
      "post" : {
        "description" : "The method creates an approval configuration in API Gateway.",
        "operationId" : "createApprovalConfiguration",
        "consumes" : [ "application/json" ],
        "produces" : [ "application/json" ],
        "parameters" : [ {
          "in" : "body",
          "name" : "body",
          "description" : "This parameter describes the request payload of an approval configuration that is to be created in API Gateway.",
          "required" : true,
          "schema" : {
            "$ref" : "#/definitions/ApprovalConfiguration"
          },
          "x-examples" : {
            "application/json" : "{\r\n    \"approvalConfig\": {\r\n        \"id\": \"createApplication\",\r\n        \"eventType\": \"createApplication\",\r\n        \"isEnabled\": true,\r\n        \"approversGroupId\": \"0936de2c-9fb9-4625-b5b0-b7648e0d4103\",\r\n        \"approvalMode\": \"anyone\",\r\n        \"approvedEmailConfiguration\": {\r\n            \"emailSubject\": \"Approval of @event.type\",\r\n            \"emailContent\": \"Congratulations @requestor.name !\\n\\nYour request for @event.type has been approved.\",\r\n            \"enabled\": false,\r\n            \"requestType\": \"approved\"\r\n        },\r\n        \"rejectedEmailConfiguration\": {\r\n            \"emailSubject\": \"Rejection of @event.type\",\r\n            \"emailContent\": \"Hello @requestor.name,\\n\\nYour @event.type  request has been rejected.\\nReasons:@rejectionReason.\\n\\nBest Regards,\\nAPI Gateway Team\\n\\n*** This notification was sent automatically. Do not reply to this email.***\",\r\n            \"enabled\": false,\r\n            \"requestType\": \"rejected\"\r\n        },\r\n        \"initiateApprovalRequestEmailConfiguration\": {\r\n            \"emailSubject\": \"Approval request pending\",\r\n            \"emailContent\": \"Hello @approver.name,\\n\\n A request by @requestor.name to @event.type needs your review and approval.\\n\\nBest Regards,\\nAPI Gateway Team\\n\\n*** This notification was sent automatically. Do not reply to this email.***\",\r\n            \"enabled\": false,\r\n            \"requestType\": \"initiate\"\r\n        }\r\n    }\r\n}"
          }
        } ],
        "responses" : {
          "200" : {
            "description" : "This status code indicates that the approval configuration has been successfully created in API Gateway.",
            "examples" : {
              "application/json" : "{\r\n    \"approvalConfig\": {\r\n        \"id\": \"createApplication\",\r\n        \"eventType\": \"createApplication\",\r\n        \"isEnabled\": true,\r\n        \"approversGroupId\": \"0936de2c-9fb9-4625-b5b0-b7648e0d4103\",\r\n        \"approvalMode\": \"anyone\",\r\n        \"approvedEmailConfiguration\": {\r\n            \"emailSubject\": \"Approval of @event.type\",\r\n            \"emailContent\": \"Congratulations @requestor.name !\\n\\nYour request for @event.type has been approved.\",\r\n            \"enabled\": false,\r\n            \"requestType\": \"approved\"\r\n        },\r\n        \"rejectedEmailConfiguration\": {\r\n            \"emailSubject\": \"Rejection of @event.type\",\r\n            \"emailContent\": \"Hello @requestor.name,\\n\\nYour @event.type  request has been rejected.\\nReasons:@rejectionReason.\\n\\nBest Regards,\\nAPI Gateway Team\\n\\n*** This notification was sent automatically. Do not reply to this email.***\",\r\n            \"enabled\": false,\r\n            \"requestType\": \"rejected\"\r\n        },\r\n        \"initiateApprovalRequestEmailConfiguration\": {\r\n            \"emailSubject\": \"Approval request pending\",\r\n            \"emailContent\": \"Hello @approver.name,\\n\\n A request by @requestor.name to @event.type needs your review and approval.\\n\\nBest Regards,\\nAPI Gateway Team\\n\\n*** This notification was sent automatically. Do not reply to this email.***\",\r\n            \"enabled\": false,\r\n            \"requestType\": \"initiate\"\r\n        }\r\n    }\r\n}"
            },
            "schema" : {
              "$ref" : "#/definitions/ApprovalConfiguration"
            }
          },
          "400" : {
            "description" : "This status code indicates that the given approval configuration request body is not correct."
          },
          "401" : {
            "description" : "This status code indicates that either user didn't provide right credentials or user doesn't have required privileges to access this API."
          }
        },
        "security" : [ {
          "Basic" : [ ]
        } ]
      }
    }
  },
  "securityDefinitions" : {
    "Basic" : {
      "description" : "API Gateway Administrator and API Gateway provider",
      "type" : "basic"
    }
  },
  "definitions" : {
    "ApprovalRequest" : {
      "type" : "object",
      "properties" : {
        "id" : {
          "type" : "string"
        },
        "approversGroupId" : {
          "type" : "string"
        },
        "approvalEvent" : {
          "type" : "string"
        },
        "requestorId" : {
          "type" : "string"
        },
        "requestorName" : {
          "type" : "string"
        },
        "requestorMail" : {
          "type" : "string"
        },
        "mode" : {
          "type" : "string"
        },
        "created" : {
          "type" : "string"
        },
        "lastUpdated" : {
          "type" : "string"
        },
        "status" : {
          "type" : "string"
        },
        "requesterComment" : {
          "type" : "string"
        },
        "subjectId" : {
          "type" : "string"
        },
        "approvalEventPayloadAsString" : {
          "type" : "string"
        },
        "approvers" : {
          "type" : "array",
          "items" : {
            "$ref" : "#/definitions/Approver"
          }
        },
        "properties" : {
          "type" : "object",
          "additionalProperties" : {
            "type" : "string"
          }
        }
      }
    },
    "ApprovalResponse" : {
      "type" : "object",
      "properties" : {
        "status" : {
          "type" : "string"
        }
      }
    },
    "Approver" : {
      "type" : "object",
      "properties" : {
        "id" : {
          "type" : "string"
        },
        "name" : {
          "type" : "string"
        },
        "status" : {
          "type" : "string"
        },
        "email" : {
          "type" : "string"
        },
        "customProperties" : {
          "type" : "object",
          "additionalProperties" : {
            "type" : "string"
          }
        }
      }
    },
    "ApprovalConfiguration" : {
      "type" : "object",
      "properties" : {
        "id" : {
          "type" : "string",
          "description" : "Unique identifier of a Approval Configuration. Any of 'createApplication', 'updateApplication', 'registerApplication', 'subscribePackage' and 'changeOwner'"
        },
        "eventType" : {
          "type" : "string",
          "description" : "Event Type: Any of 'createApplication', 'updateApplication', 'registerApplication', 'subscribePackage' and 'changeOwner'"
        },
        "isEnabled" : {
          "type" : "boolean",
          "description" : "true/false. true value enforces approvals for the mentioned eventtype"
        },
        "approversGroupId" : {
          "type" : "string",
          "description" : "Approvers Accessprofile Identifier. Whoever belongs to the selected team will be considered as Approvers"
        },
        "approvalMode" : {
          "type" : "string",
          "description" : "Only possible value is anyone. This implies that, any one user associated with the approvers team can approve or reject the requests. The requester need not wait for the approval of each approver in the approvers group."
        },
        "approvedEmailConfiguration" : {
          "$ref" : "#/definitions/EmailConfiguration"
        },
        "rejectedEmailConfiguration" : {
          "$ref" : "#/definitions/EmailConfiguration"
        },
        "initiateApprovalRequestEmailConfiguration" : {
          "$ref" : "#/definitions/EmailConfiguration"
        }
      },
      "description" : "This model contains details about an ApprovalConfiguration in API Gateway"
    },
    "EmailConfiguration" : {
      "type" : "object",
      "properties" : {
        "emailSubject" : {
          "type" : "string",
          "description" : "Email Subject"
        },
        "emailContent" : {
          "type" : "string",
          "description" : "Email Content"
        },
        "enabled" : {
          "type" : "boolean",
          "description" : "true/false. Email would be sent to user only when enabled value is true."
        },
        "requestType" : {
          "type" : "string",
          "description" : "Request Type. Value would be any of initiated, approved or rejected."
        }
      },
      "description" : "This model contains details about an EmailConfiguration configured in Approvals of API Gateway"
    }
  }
}